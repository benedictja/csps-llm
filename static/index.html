<!DOCTYPE html>
<html lang="en" data-theme="cupcake">

<head>
    <title>Whisper</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- CDN resources -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daisyui@4.4.20/dist/full.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@14.0.0/dist/markdown-it.min.js"></script>
    <!-- local resources -->
    <script src="js/main.js"></script>
    <link href="css/main.css" rel="stylesheet"  />
</head>


<body>

    <div class="footer">
        <div class="join w-full flex">
            <input type="text" class="input input-bordered join-item grow" id="prompt" />
            <button id="listen-button" class="btn btn-active join-item" hidden>Listen &#x1F399;</button>
            <input type="checkbox" id="speech-toggle" aria-label="Speak &#x1F5E3;" name="speech"
                class="btn btn-outline join-item"></input>
        </div>
    </div>
    <hr />
    <img id="botImage" src="img/agent.svg" width="3em" height="3em" />
    <div id="dialogue">

    </div>
    <!--div id="thinker">&#x1F914;</div-->
    <span id="thinker" class="loading loading-dots loading-sm"></span>
    <script>

        // Bind the "enter" keystroke.
        var input = document.getElementById("prompt");

        input.addEventListener("keypress", function (event) {
            if (currentAudio) {
                currentAudio.pause();
            }
            if (event.key === "Enter") {
                event.preventDefault();
                sendPrompt();
            }
        });
        if (window.hasOwnProperty('webkitSpeechRecognition')) {
            var listenButton = document.getElementById('listen-button');
            listenButton.hidden = false;
            listenButton.addEventListener("click", function (event) {
                startDictation();
            });
        }
        input.focus();
        thinkerElement = document.getElementById("thinker");
        thinkerElement.parentElement.removeChild(thinkerElement);
        botImage = document.getElementById("botImage");
        botImage.parentElement.removeChild(botImage);
        // Set up the first interaction
        window.addEventListener("load", function (event) {

            var dialogueElement = document.getElementById('dialogue');
            chatElement = document.createElement('div');
            chatElement.classList.add('chat');
            chatElement.classList.add('chat-start');
            avatarElement = document.createElement('div');
            avatarElement.classList.add('chat-image');
            avatarElement.classList.add('avatar');
            avatarHolderElement = document.createElement('div');
            avatarHolderElement.classList.add("w-10");
            avatarHolderElement.classList.add("rounded-full");
            avatarHolderElement.append(botImage);
            avatarElement.append(avatarHolderElement);
            chatElement.append(avatarElement);
            outputElement = document.createElement('div');
            outputElement.classList.add('chat-bubble');
            outputElement.classList.add('chat-bubble-info');

            outputElement.append(document.createTextNode("Hello, my name is Whisper. I'm a Large Language Model that works for the CSPS. I'm only allowed to handle unclassified information, and if you use anything I write, please make sure that people know that an AI wrote it. How can I help you today?"));
            // outputElement.classList.add('bot');
            dialogueElement.append(chatElement);
            chatElement.append(outputElement);
            outputElement.classList.add('animate__animated');
            outputElement.classList.add('animate__fadeIn');
            outputElement.classList.add('animate__delay-2s');
        });
    </script>
</body>

</html>
